var app=angular.module("time",["ngRoute","angularSpinner"]);app.config(["$routeProvider",function(n){n.when("/",{templateUrl:"templates/login.html",controller:"LoginCtrl"}).when("/login",{templateUrl:"templates/login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"templates/register.html",controller:"RegisterCtrl"}).when("/dashboard",{templateUrl:"templates/dashboard.html",controller:"DashboardCtrl"}).when("/courses",{templateUrl:"templates/courses.html",controller:"CoursesCtrl"}).when("/course/:ID",{templateUrl:"templates/course.html",controller:"CourseCtrl"}).when("/project/:ID",{templateUrl:"templates/project.html",controller:"ProjectCtrl"}).when("/group/:ID",{templateUrl:"templates/group.html",controller:"GroupCtrl"}).when("/users",{templateUrl:"templates/users.html",controller:"UsersCtrl"}).when("/user/:ID",{templateUrl:"templates/user.html",controller:"UserCtrl"}).otherwise("/")}]);app.config(["usSpinnerConfigProvider",function(n){n.setDefaults({color:"#18BC9C",radius:15})}]);app.filter("orderObjectBy",function(){return function(n,t,i){var r=[];return angular.forEach(n,function(n){r.push(n)}),r.sort(function(n,i){return n[t]>i[t]?1:-1}),i&&r.reverse(),r}});angular.module("time").controller("MasterCtrl",["$scope","$http","$routeParams","$location","usSpinnerService",function(n,t,i,r,u){n.user=null;n.loaded=!1;toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"200",hideDuration:"500",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.collapse=function(){$(".navbar-collapse").collapse("hide")};n.userExists=function(){return n.user!==null?($("#navbarSupportedContent").removeClass("invisible"),!0):!1};n.logout=function(){u.spin("spinner");t.get("/Home/Logout").then(function(){n.user=null;u.stop("spinner");r.path("/login")},function(){u.stop("spinner");toastr.error("Failed to logout.")})}}]);angular.module("time").controller("LoginCtrl",["$scope","$http","$routeParams","$location","usSpinnerService",function(n,t,i,r,u){n.loaded=!1;n.user={};n.password="";n.load=function(){n.login=function(){if(n.user.username===""){toastr.error("Please enter a Username");return}if(n.password===""){toastr.error("Please enter a Password");return}n.user.password=CryptoJS.SHA256(n.password).toString(CryptoJS.enc.Hex);u.spin("spinner");t.post("/Home/LoginUser",n.user).then(function(n){u.stop("spinner");n.status===204?toastr.error("Username does not exist."):r.path("/dashboard")},function(n){u.stop("spinner");n.status===401?toastr.error("Password incorrect."):n.status===403&&toastr.error("User account has been deactivated.")})};n.register=function(){r.path("/register")};n.loaded=!0;$("#username").focus()};u.spin("spinner");t.get("/Home/CheckSession").then(function(t){if(u.stop("spinner"),t.data===""){n.load();return}n.$parent.user=t.data;n.$parent.loaded=!0;n.$parent.user.type==="A"||n.$parent.user.type==="I"?r.path("/courses"):r.path("/dashboard")},function(){u.stop("spinner");n.$parent.loaded=!0;n.load()})}]);