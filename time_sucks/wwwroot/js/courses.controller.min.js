angular.module("time").controller("CoursesCtrl",["$scope","$http","$routeParams","$location","usSpinnerService",function(n,t,i,r,u){n.loaded=!1;n.search="";n.config={};n.config.showInactiveCourses=!1;n.load=function(){u.spin("spinner");t.get("/Home/GetCourses").then(function(t){u.stop("spinner");n.courses=t.data},function(){u.stop("spinner");toastr.error("Error retrieving courses.")});n.createCourse=function(){t.post("/Home/AddCourse",n.user).then(function(n){r.path("/course/"+n.data)},function(n){n.status===401?toastr.error("Unauthorized to create a course."):toastr.error("Failed to create course, unknown error.")})};n.loaded=!0};n.$parent.user&&n.$parent.user!==""?n.load():t.get("/Home/CheckSession").then(function(t){n.$parent.user=t.data;n.$parent.loaded=!0;n.load()},function(){toastr.error("Not logged in.");r.path("/login")})}]);